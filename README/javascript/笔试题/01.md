# 目录

- [修改下面的定时器，输入 1-5?](##1)
- [美图：取出一段 url 的参数重新组合成对象中的 key 和 value 的形式？](##1)
- [美图：如何找出字符串中出现最多的字符？](##1)
- [美团：数组去重排序: let arr = [1, 4, 6, [2, 1, 3, 0, [19, 1, 23, 6, 32, 10]]];](##1)
- [美团：如何实现批量打印数字：比如有 0-100 个数字，第一秒打印 0-4，第二秒打印 5-9，依次类推，直至打印完所有数字。](##1)
- [美团:将 name 相同的项目合并，他们的 menu 值相加（数据合并）](##1)
- [美团：将 array1 转换成 array2](##1)
- [盛派：面试题](##1)
- [协创：面试题](##1)

## 问题：修改下面的定时器，输入 1-5?

```js
for (var i = 0; i < 6; i++) {
  setTimeout(function () {
    console.log(i)
  }, 1000)
}
```

答案：

```js
// 第一种  使用块级作用域
for (let i = 0; i < 6; i++) {
  setTimeout(function () {
    console.log(i)
  }, 1000)
}
// 第二种  利用setTimeout第三个参数
for (var i = 0; i < 6; i++) {
  setTimeout(
    function (val) {
      console.log(val)
    },
    1000,
    i
  )
}
// 第三种，利用闭包
for (var i = 0; i < 6; i++) {
  ;(function (y) {
    setTimeout(function () {
      console.log(y)
    }, 1000)
  })(i)
}
```

## 美图：取出一段 url 的参数重新组合成对象中的 key 和 value 的形式？

1. 案例如下：let url = "https://google.com?id=123&searchKey=word"; 转化成 let newUrl = "https://google.com?{'id':'123','searchKey':'word'}";

```js
let url = 'https://google.com?id=123&searchKey=word'
let str = url.split('?')[1]
let obj = {}
str.split('&').forEach(item => {
  let key = item.split('=')[0]
  let value = item.split('=')[1]
  obj[key] = value
})
let newObj = url.split('?')[0] + '?' + JSON.stringify(obj)
```

## 美图：如何找出字符串中出现最多的字符？

1. let str = "aaabbbbacccdde";

```js
let str = 'aaabbbbacbccdde'
let obj = str.split('').reduce((pred, item, index, arr) => {
  arr.indexOf(item) === index ? (pred[item] = 1) : pred[item]++
  return pred
}, {})
let maxNum = Math.max(...Object.values(obj))
for (let key in obj) {
  if (obj[key] === maxNum) {
    console.log(key)
  }
}
```

第一步：声明一个全局变量对象字面量，遍历当前的字符串，判断当前的字符中的每一个字符是否存在当前的字面量的 keys 中，如果存在则当前的字符进行自增 1，如果不存在则赋值默认为 1，这样可以获取一个新的对象，对象中存储每一个字符出现的次数。

```js
let str = 'aaabbbbacccdde'
let obj = {}
for (let i = 0; i < str.length; i++) {
  if (Object.keys(obj).includes(str[i])) {
    obj[str[i]]++
  } else {
    obj[str[i]] = 1
  }
}
console.log(obj) // {a: 4, b: 4, c: 3, d: 2, e: 1}
```

第二种：拿到对象后，通过 Object.values()的方式取出当前 value 组成的数组，然后通过 Math.max()函数取出最大的数，再用 for..in 遍历当前的对象，通过 value 去查找 key。

```js
// 第一种
let obj = { a: 4, b: 4, c: 3, d: 2, e: 1 }
for (let key in obj) {
  if (obj[key] === Math.max(...Object.values(obj))) {
    console.log(key) // a,b
  }
}

// 第二种
var max = 0
let num = ''
for (var key in obj) {
  if (max < obj[key]) {
    max = key
    num = obj[key]
  }
}
console.log({ [max]: num }) //{a: 4}
```

## 美团：数组去重排序: let arr = [1, 4, 6, [2, 1, 3, 0, [19, 1, 23, 6, 32, 10]]];

```js
let arr = [1, 4, 6, [2, 1, 3, 0, [19, 1, 23, 6, 32, 10]]]
let newArr = []
function toNewArr(arr) {
  for (let i = 0; i < arr.length; i++) {
    Array.isArray(arr[i]) ? toNewArr(arr[i]) : newArr.push(arr[i])
  }
}
toNewArr(arr)
let filterArr = newArr.filter((item, index, arr) => arr.indexOf(item) === index)
console.log(filterArr)
```

## 美团：如何实现批量打印数字：比如有 0-100 个数字，第一秒打印 0-4，第二秒打印 5-9，依次类推，直至打印完所有数字。

```js
// 第一种使用 setInterval 实现
let arr = []
for (let i = 0; i < 101; i++) {
  arr.push(i)
}
let index = 0
setInterval(() => {
  for (let i = 0; i < 5; i++) {
    console.log(arr[index]) //
    index++
  }
}, 1000)

// 使用 setTimeout 实现
let i = 0
function run() {
  for (let j = 0; j < 5 && i < 100; i++, j++) {
    console.log(i)
  }
  setTimeout(() => {
    run()
  }, 1000)
}
run()
```

## 美团:将 name 相同的项目合并，他们的 menu 值相加（数据合并）

```js
let arr = [
  { name: 'a', menu: 2 },
  { name: 'g', menu: 2 },
  { name: 'a', menu: 21 },
  { name: 'c', menu: 4 },
  { name: 'g', menu: 33 },
  { name: 'g', menu: 33 },
  { name: 'c', menu: 44 }
]

// 转换后

let arr = [
  { name: 'a', menu: 23 },
  { name: 'g', menu: 68 },
  { name: 'c', menu: 48 }
]
```

答案：

```js
// 第一种方式
let keys = Array.from(new Set(arr.map(item => item.name)))
let all = keys.map(item => {
  let values = 0
  for (let i = 0; i < arr.length; i++) {
    if (item == arr[i].name) {
      values = arr[i].menu + values
    }
  }
  return {
    name: item,
    menu: values
  }
})
console.log(all)

// 第二种方式
let all = Object.entries(
  arr.reduce((pred, item) => {
    pred[item.name] = pred[item.name] + item.menu || item.menu
    return pred
  }, {})
).map(item => {
  return {
    name: item[0],
    menu: item[1]
  }
})
console.log(all)
```

## 美团：将 array1 转换成 array2

```js
let array1 = [
  [1, 2, 3, 4],
  [5, 6, 7, 8]
]

let array2 = [
  [5, 1],
  [6, 2],
  [7, 3],
  [8, 4]
]
```

解答：

```js
let array1 = [
  [1, 2, 3, 4],
  [5, 6, 7, 8]
]

let newArr = array1[0].map((item, index) => [array1[1][index], item])
console.log(newArr)
```

对上面的题目进行变形，还是将 array1 转换成 array2?

```js
let array1 = [
  [1, 2, 3, 4],
  [5, 6, 7, 8],
  [9, 10, 11, 12],
  [13, 14, 15, 16],
  [17, 18, 19, 20]
]

let array2 = [
  [17, 13, 9, 5, 1],
  [18, 14, 10, 6, 2],
  [19, 15, 11, 7, 3],
  [20, 16, 12, 8, 4]
]
```

转换后

```js
let array2 = []
let rows = array1.length
let cols = array1[0].length
for (let index = 0; index < cols; index++) {
  let aa = []
  for (let i = 0; i < rows; i++) {
    aa.push(array1[rows - i - 1][index])
  }
  array2.push(aa)
}
console.log(array2)
```

## 盛派：面试题

```js
// 第一题考察类相关知识
class A {
  constructor() {
    this.name = '123'
  }
  sayName() {
    console.log(this.name)
  }
}

class B extends A {
  constructor() {
    super()
    this.name = '456'
  }
}
let obj = new B()
obj.sayName()

// 第二题考察 promise 的链式调用
Promise.reject('error')
  .then(
    () => {
      console.log('success1')
    },
    () => {
      console.log('error1')
    }
  )
  .then(
    () => {
      console.log('success2')
    },
    () => {
      console.log('error2')
    }
  )

// 第三题 考察定时器
function getsomething() {
  return setTimeout(() => {
    return 'hello'
  })
}
let something = getsomething()
console.log(something)

// 第四题 考察 this 指向
window.n = 'window name'
let obj = {
  n: 'obj name',
  sayN() {
    console.log(this.n)
  }
}
let fn = obj.sayN
fn()

// 第五题 考察 this 指向
window.n = 'window name'
let obj = {
  n: 'obj name',
  sayN() {
    console.log(this.n)
  }
}
obj.sayN()

// 第六题 考察 this 指向
window.n = 'window name'
let obj = {
  n: 'obj name',
  sayN: () => {
    console.log(this.n)
  }
}
obj.sayN()

// 第七题 考察 this 指向
var a = 1
function fn() {
  var a = 2
  function a() {
    console.log(3)
  }
  return a
  function a() {
    fconsole.log(4)
  }
}
var b = fn()
console.log(b)
```

## 协创：面试题

```js
// 第一题 考察事件循环
setTimeout(() => {
  console.log(2)
  Promise.resolve().then(() => {
    console.log(3)
  })
}, 0)

new Promise(function (resolve, reject) {
  console.log(4)
  setTimeout(function () {
    console.log(5)
    resolve(6)
  }, 0)
}).then(res => {
  console.log(7)
  setTimeout(() => {
    console.log(res)
  }, 0)
})
console.log(1)

// 第二题 盒模型,问题：box-sizing的属性值为content-box和border-box时，div的宽度分别为：
// div {
//     width: 200px;
//     border: 25px;
//     padding: 25px;
// 	  box-sizing: [content-box|border-box];
// }
// 答案： 总宽度分别是300px 200px

// 第三题 下面js代码执行后终端输出内容是什么？
var str = 'abc'
str += 1
var test = typeof str
if (test.length == 7) {
  var sign = 'typeof返回结果可能为String'
}
console.log(sign)

// 第四题 下面js代码执行后终端输出内容是什么？
var a = []
a.push(1, 2)
console.log(a)
a.shift(3, 4)
console.log(a)
a.concat([5, 6])
console.log(a)
a.splice(0, 1, 2)
console.log(a)

// 第五题 下面js代码执行后终端输出内容是什么？
function fn(a) {
  console.log(a)
  var a = 123
  console.log(a)
  function a() {}
  console.log(a)
  console.log(b)
  var b = function () {}
}
fn(2)

// 第六题 使用三目运算符简化以下代码（function括弧内代码缩减成一行）？
function getPayCode(payType) {
  let payCode = null
  if (payType === '支付宝') {
    payCode = 1
  } else if (payType === '微信') {
    payCode = 2
  }
  console.log(payCode)
  return payCode
}
// 改造后
function getPayCode(payType) {
  payType === '支付宝' ? (payCode = 1) : payType === '微信' ? (payCode = 2) : (payCode = null)
  return payCode
}
```
